-- DimDate
CREATE TABLE DimDate (
    date_id INTEGER PRIMARY KEY AUTOINCREMENT,
    date TEXT NOT NULL,
    year INTEGER,
    month INTEGER,
    day INTEGER
);

-- DimTransactionType
CREATE TABLE DimTransactionType (
    transaction_code_id INTEGER PRIMARY KEY AUTOINCREMENT,
    transaction_code TEXT NOT NULL
);

-- DimSymbol
CREATE TABLE DimSymbol (
    symbol_id INTEGER PRIMARY KEY AUTOINCREMENT,
    symbol TEXT NOT NULL
);

-- DimTier
CREATE TABLE DimTier (
    tier_id INTEGER PRIMARY KEY AUTOINCREMENT,
    tier TEXT NOT NULL,
    active BOOLEAN NOT NULL,
    benefits TEXT
);

-- DimCustomer
CREATE TABLE DimCustomer (
    customer_id INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT NOT NULL,
    name TEXT NOT NULL,
    birthdate TEXT NOT NULL,
    email TEXT NOT NULL,
    address TEXT NOT NULL,
    tier_id INTEGER,
    FOREIGN KEY (tier_id) REFERENCES DimTier(tier_id)
);

-- DimAccount
CREATE TABLE DimAccount (
    account_id INTEGER PRIMARY KEY,
    account_limit DECIMAL
);

-- FactTransaction
CREATE TABLE FactTransaction (
    transaction_id INTEGER PRIMARY KEY AUTOINCREMENT,
    account_id INTEGER NOT NULL,
    date_id INTEGER NOT NULL,
    transaction_code_id INTEGER NOT NULL,
    symbol_id INTEGER NOT NULL,
    amount DECIMAL NOT NULL,
    price DECIMAL NOT NULL,
    total DECIMAL NOT NULL,
    FOREIGN KEY (account_id) REFERENCES DimAccount(account_id),
    FOREIGN KEY (date_id) REFERENCES DimDate(date_id),
    FOREIGN KEY (transaction_code_id) REFERENCES DimTransactionType(transaction_code_id),
    FOREIGN KEY (symbol_id) REFERENCES DimSymbol(symbol_id)
);
